# API列表

## 法币币种充值接口

### 应用场景

BitFS支付是指商户在PC端或者移动端网页展示商品或服务，用户在前述页面确认使用BitFS支付时，商户发起本服务呼起【BitFS】APP进行快速支付。 主要用于智能手机浏览器请求BitFS支付的场景。可以方便地从外部浏览器唤起BitFS支付。当商户商品以法币标价时调用本接口。

### 概括

- API名称：充值接口----法币标价

*  请求方式：HTTP POST
* 请求URL：pay/v1/unifiedorder

### 请求参数

>request:

~~~java
{
 	"mch_id":"441649692783284224",
 	"device_type":"PC",
 	"nonce_str":"FEC838C0BEA5468A82E2467DA4F70B8C",
    "local":"en_US",
 	"out_trade_no":"7faf7e60a92d4afa963b83933a949ecc",
 	"spbill_create_ip":127.0.0.1,
 	"fee_type":"CNY",
 	"trade_type":"DEPOSIT",
 	"body":"小游戏-点券充值",
 	"total_amount":"100",
 	"notify_url":"https://www.baidu.com",
 	"timestamp":1585471277677,
 	"appKey":"fc798420836184e33c042de1caa2814a",
 	"sign":"F752ABD95162A4A95E7C4A5E33DAEDD9"
}
~~~

| 字段         | 变量名           | 类型       | 必填  | 示例值                           | 描述                                                         |
| ------------ | :--------------- | ---------- | :---- | :------------------------------- | :----------------------------------------------------------- |
| 商户ID       | mch_id           | String     | true  | 441649692783284224               | BitFS分配的商户ID                                            |
| 设备类型     | device_type      | String     | true  | PC                               | 发起请求的设备来自移动端还是PC端                             |
| 附加数据     | attach           | String     | false | 广州总店                         | 附加数据，在查询API和支付通知中原样返回，该字段主要用于商户携带订单的自定义数据 |
| 随机字符串   | nonce_str        | String     | true  | FEC838C0BEA5468A82E2467DA4F70B8C | 随机字符串,不长于32位                                        |
| 本地语言     | local            | String     | true  | en_US                            | 本地网络语言按国际标准填写                                   |
| 商户订单号   | out_trade_no     | String     | true  | 7faf7e60a92d4afa963b83933a949ecc | 商户系统内部订单号，要求32个字符内，只能是数字、大小写字母且在同一个商户号下唯一 |
| 终端ip       | spbill_create_ip | String     | true  | 127.0.0.1                        | 必须传正确的用户端IP,支持ipv4、ipv6格式                      |
| 签名类型     | sign_type        | String     | false | MD5                              | 签名类型，默认为MD5                                          |
| 货币类型     | fee_type         | String     | true  | CNY                              | 符合ISO 4217标准的三位字母代码，[详见法币列表](#d6a9971a56)  |
| 交易类型     | trade_type       | String     | true  | DEPOSI                           | 充币：DEPOSIT  提币：WITHDRAW                                |
| 商品描述     | body             | String     | true  | “小游戏-点券充值”                | 商品简单描述，该字段须严格按照规范传递                       |
| 充值金额     | total_amount     | BigDecimal | true  | 100                              | 订单总金额                                                   |
| 结果通知地址 | notify_url       | String     | true  | https://www.baidu.com            | 接收BitFS支付异步通知回调地址，详情参考  ”回调通知"          |
| 时间戳       | timestamp        | String     | true  | 1585471277677                    | 发起订单时的时间毫秒数                                       |
| 商户appKey   | appKey           | String     | true  | 1e75e94982f80bd1f219ea807af96bd5 | BitFS分配的商户appKey                                        |
| 签名         | sign             | String     | true  | 13F9609AA53A8AEBED5516EE8696A995 | 签名，[详见签名生成算法](#7b81b8ce22)                        |

### 返回结果

>response:

~~~java
{
    "code": 0,
    "msg": "請求成功",
    "result": "{
        "pay_url":"http://174.139.156.39:8866/#/?id=439535840037699584",
    	"mch_id":"441649692783284224",
    	"trade_type":"DEPOSIT",
    	"nonce_str":"FEC838C0BEA5468A82E2467DA4F70B8C",
    	"sign":"F752ABD95162A4A95E7C4A5E33DAEDD9"
	}"
}
~~~

| 字段       | 变量名  | 必填 | 类型        | 示例值  | 描述                                                         |
| ---------- | ------- | ---- | ----------- | ------- | ------------------------------------------------------------ |
| 返回状态码 | code    | true | Int         | 0       | 网关返回码，调用成功时返回0                                  |
| 返回信息   | msg     | true | String(255) | success | 当code不为0时返回信息为错误原因 ，例如:签名失败;参数格式校验错误 |

<aside class="notice">以下字段在code为0时有返回</aside>

| 字段         | 变量名     | 必填 | 类型   | 示例值                                                | 描述                                                         |
| :----------- | :--------- | :--- | ------ | ----------------------------------------------------- | ------------------------------------------------------------ |
| 支付跳转链接 | pay_url    | true | String | http://174.139.156.39:8844/#/currency/currinformation | pay_url为拉起BitFS支付中间页面可通过扫该页面拉起BitFS的App支付界面完成支付，有效时间5分钟 |
| 商户ID       | mch_id     | true | String | 441649692783284224                                    | BitFS分配给商户的id                                          |
| 交易类型     | trade_type | true | String | DEPOSIT                                               | 充币:DEPOSIT      提币:WITHDRAW                              |
| 随机字符     | nonce_str  | true | String | FEC838C0BEA5468A82E2467DA4F70B8C                      | BitFS返回的随机字符串                                        |
| 签名         | sign       | true | String | F752ABD95162A4A95E7C4A5E33DAEDD9                      | BitFS返回的签名                                              |

### 错误码

| 名称                   | 描述                         | 原因                         | 解决方案                                    |
| ---------------------- | ---------------------------- | ---------------------------- | ------------------------------------------- |
| APPKEY_MCHID_NOT_MATCH | 商户machId与商户appkey不匹配 | 商户machId与商户appkey不匹配 | 请确认appid和mch_id是否匹配                 |
| SIGNERROR              | 签名错误                     | 参数签名结果不正确           | 请检查签名参数和方法是否都符合签名算法要求  |
| OUT_TRADE_NO_USED      | 商户订单号重复               | 同一笔交易不能多次提交       | 请核实商户订单号是否重复提交                |
| LACK_PARAMS            | 缺少参数                     | 缺少必要的请求参数           | 请检查参数是否齐全                          |
| SYSTEMERROR            | 系统错误                     | 系统超时                     | 系统异常，请用相同参数重新调用              |
| COIN_NOT_EXIST         | 币种不支持                   | 请求的币种不支持             | 请参考[币种列表](#d6a9971a56)上传正确的币种 |
| ACCOUNT_NOT_EXIST      | 账户不存在                   | 商户账户不存在               | 请对商户账户信息是否正确                    |

## 数字货币币种充值接口

### 应用场景

BitFS 支付是指商户在PC端或者移动端网页展示商品或服务，用户在前述页面确认使用BitFS 支付时，商户发起本服务呼起BitFS APP进行快速支付。 主要用于智能手机浏览器请求BitFS 支付的场景。可以方便地从外部浏览器唤起BitFS 支付。当商户商品以数字货币标价时调用本接口。

### 概括

* API名称：充值接口-数字货币标价

* 请求方式：HTTP POST
* 请求URL：pay/v1/coinunifiedorder

### 请求参数

>request:

~~~java
{
    "mch_id":"441649692783284224",
    "device_type":"PC",
    "nonce_str":"FEC838C0BEA5468A82E2467DA4F70B8C",
    "local":"en_US",
    "out_trade_no":"7faf7e60a92d4afa963b83933a949ecc",
    "spbill_create_ip":127.0.0.1,
    "fee_type":"BTC",
    "trade_type":"DEPOSIT",
    "body":"小游戏-点券充值",
    "total_amount":"1000",
    "notify_url":"https://www.baidu.com",
    "timestamp":1585471277677,
    "appKey":"fc798420836184e33c042de1caa2814a",
    "sign":"F752ABD95162A4A95E7C4A5E33DAEDD9"
}
~~~

| 字段         | 变量名           | 类型       | 必填  | 示例值                           | 描述                                                         |
| ------------ | ---------------- | ---------- | ----- | -------------------------------- | ------------------------------------------------------------ |
| 商户ID       | mch_id           | String     | true  | 441649692783284224               | BitFS分配的商户ID                                            |
| 设备类型     | device_type      | String     | true  | PC                               | 发起请求的设备来自移动端还是PC端。                           |
| 附加数据     | attach           | String     | false | 广州总店                         | 附加数据，在查询API和支付通知中原样返回，该字段主要用于商户携带订单的自定义数据。 |
| 随机字符串   | nonce_str        | String     | true  | FEC838C0BEA5468A82E2467DA4F70B8C | 随机字符串，不长于32位。                                     |
| 本地语言     | local            | String     | true  | en_US                            | 本地网络语言按国际标准填写                                   |
| 商户订单号   | out_trade_no     | String     | true  | 7faf7e60a92d4afa963b83933a949ecc | 商户系统内部的订单号,32个字符内、可包含字母。                |
| 签名类型     | sign_type        | String     | false | MD5                              | 签名类型，默认为MD5                                          |
| 终端ip       | spbill_create_ip | String     | true  | 127.0.0.1                        | 必须传正确的用户端IP,支持ipv4、ipv6格式                      |
| 货币类型     | fee_type         | String     | true  | BTC                              | 符合ISO 4217标准的三位字母代码，详见数字货币列表             |
| 交易类型     | trade_type       | String     | true  | DEPOSIT                          | 充币DEPOSIT  提币WITHDRAW                                    |
| 商品描述     | body             | String     | true  | “小游戏-点券充值”                | 商品简单描述，该字段须严格按照规范传递                       |
| 充值金额     | total_amount     | BigDecimal | true  | 1000                             | 订单总金额                                                   |
| 结果通知地址 | notify_url       | String     | true  | https://www.baidu.com            | 接收BitFS支付异步通知回调地址，详情参考  ”回调通知“          |
| 时间戳       | timestamp        | String     | true  | 1585471277677                    | 发起订单时的时间毫秒数                                       |
| 商户appKey   | appKey           | String     | true  | 1e75e94982f80bd1f219ea807af96bd5 | BitFS分配的商户appKey                                        |
| 签名         | sign             | String     | true  | 13F9609AA53A8AEBED5516EE8696A995 | 签名，[详见签名生成算法](#7b81b8ce22)，默认MD5               |

### 返回结果

~~~java
{
    "code": 0,
    "msg": "請求成功",
    "result": "{
        "pay_url":"http://174.139.156.39:8866/#/?id=439535840037699584",
    	"mch_id":"441649692783284224",
    	"trade_type":"DEPOSIT",
    	"nonce_str":"FEC838C0BEA5468A82E2467DA4F70B8C",
    	"sign":"F752ABD95162A4A95E7C4A5E33DAEDD9"
	}"

}
~~~

| 字段       | 变量名 | 必填 | 类型        | 示例值  | 描述                                                         |
| :--------- | ------ | ---- | ----------- | ------- | ------------------------------------------------------------ |
| 返回状态码 | code   | true | Int         | 0       | 网关返回码，调用成功时返回0                                  |
| 返回信息   | msg    | true | String(255) | success | 当code不为0时返回信息为错误原因 ，例如:签名失败；参数格式校验错误 |

<aside class="notice">以下字段在code为0时有返回</aside>

| 字段         | 变量       | 必填 | 类型   | 示例值                                                | 描述                                                         |
| ------------ | ---------- | ---- | ------ | ----------------------------------------------------- | ------------------------------------------------------------ |
| 支付跳转链接 | pay_url    | true | String | http://174.139.156.39:8844/#/currency/currinformation | pay_url为拉起BitFS支付中间页面可通过扫该页面拉起BitFS的App支付界面完成支付，有效时间5分钟 |
| 商户ID       | mch_id     | true | String | 441649692783284224                                    | BitFS分配给商户的id                                          |
| 交易类型     | trade_type | true | String | DEPOSIT                                               | 充币:DEPOSIT      提币:WITHDRAW                              |
| 随机字符     | nonce_str  | true | String | FEC838C0BEA5468A82E2467DA4F70B8C                      | BitFS返回的随机字符串                                        |
| 签名         | sign       | true | String | F752ABD95162A4A95E7C4A5E33DAEDD9                      | BitFS返回的签名                                              |

### 错误码

| 名称                   | 描述                         | 原因                         | 解决方案                                   |
| ---------------------- | ---------------------------- | ---------------------------- | ------------------------------------------ |
| APPKEY_MCHID_NOT_MATCH | 商户machId与商户appkey不匹配 | 商户machId与商户appkey不匹配 | 请确认appid和mch_id是否匹配                |
| SIGNERROR              | 签名错误                     | 参数签名结果不正确           | 请检查签名参数和方法是否都符合签名算法要求 |
| OUT_TRADE_NO_USED      | 商户订单号重复               | 同一笔交易不能多次提交       | 请核实商户订单号是否重复提交               |
| LACK_PARAMS            | 缺少参数                     | 缺少必要的请求参数           | 请检查参数是否齐全                         |
| SYSTEMERROR            | 系统错误                     | 系统超时                     | 系统异常，请用相同参数重新调用             |
| COIN_NOT_EXIST         | 币种不支持                   | 请求的币种不支持             | 请参考币种列表上传正确的币种               |
| ACCOUNT_NOT_EXIST      | 账户不存在                   | 商户账户不存在               | 请对商户账户信息是否正确                   |

 

## 查询充值/提币支持的法币币种接口

### 应用场景

用于查询调用BitFS充值/提币接口时BitFS可以支持的法币币种，可以实时校验调用接口币种是否支持。 

### 概括

* API名称：查询充值/提币支持的法币币种接口
* 请求方式：HTTP GET
* 请求URL：pay/v1/currencyList

### 请求参数

NULL

### 返回结果

| 字段       | 变量名 | 必填 | 类型        | 示例值  | 描述                                            |
| ---------- | ------ | ---- | ----------- | ------- | ----------------------------------------------- |
| 返回状态码 | code   | true | Int         | 0       | 返回码，调用成功时返回0                         |
| 返回信息   | msg    | true | String(255) | success | 当code不为0时返回信息为错误原因 ，例如:请求超时 |

<aside class="notice">以下字段在code=0时有返回</aside>

| 字段   | 变量名   | 必填 | 类型   | 示例值 | 描述       |
| ------ | -------- | ---- | ------ | ------ | ---------- |
| 币名称 | fee_name | true | String | 人民币 | 法币的名称 |
| 币编码 | fee_type | true | String | CNY    | 法币编码值 |

## 查询充值/提币支持的数字货币币种接口

### 应用场景

用于查询调用BitFS充值/提币接口时BitFS可以支持的数字货币币种，可以实时校验调用接口币种是否支持。 

### 概括

* API名称：查询充值/提币支持的数字货币币种接口
* 请求方式：HTTP GET
*  请求URL：pay/v1/digiccyList

### 请求参数

NULL

### 返回结果

| 字段       | 变量名 | 必填 | 类型        | 示例值  | 描述                                            |
| ---------- | ------ | ---- | ----------- | ------- | ----------------------------------------------- |
| 返回状态码 | code   | true | Int         | 0       | 返回码，调用成功时返回0                         |
| 返回信息   | msg    | true | String(255) | success | 当code不为0时返回信息为错误原因 ，例如:请求超时 |

<aside class="notice">以下字段在code=0时有返回</aside>

| 字段   | 变量名   | 必填 | 类型   | 示例值 | 描述           |
| ------ | -------- | ---- | ------ | ------ | -------------- |
| 币名称 | fee_name | true | String | 比特币 | 数字货币的名称 |
| 币编码 | fee_type | true | String | BTC    | 数字货币编码值 |

## 法币币种提币接口

### 应用场景

当BitFS用户在商户系统发起提现时，商户系统调用本接口可以方便地使用商户账户向用户转账，BitFS以实时行情汇率将法币金额兑换成USDT。

### 概括

* API名称：提币接口-法币接口

* 请求方式：HTTP POST

* 请求URL：pay/v1/withdraw

### 请求参数

> request:

~~~java
{
    "mch_id":"441649692783284224",
    "area_code":"0086",
    "get_account":"13899996666",
    "nonce_str":"FEC838C0BEA5468A82E2467DA4F70B8C",
    "out_trade_no":"7faf7e60a92d4afa963b83933a949ecc",
    "spbill_create_ip":127.0.0.1,
    "fee_type":"CNY",
    "trade_type":"WITHDRAW",
    "total_amount":"100",
    "notify_url":"https://www.baidu.com",
    "timestamp":1585471277677,
    "appKey":"fc798420836184e33c042de1caa2814a",
    "sign":"F752ABD95162A4A95E7C4A5E33DAEDD9"
}
~~~

| 字段           | 变量名           | 类型       | 必填  | 示例值                           | 描述                                                         |
| -------------- | ---------------- | ---------- | ----- | -------------------------------- | ------------------------------------------------------------ |
| 商户ID         | mch_id           | String     | true  | 441649692783284224               | BitFS分配的商户ID                                            |
| 提币账户归属地 | area_code        | String     | true  | 0086                             | 提币账户归属地                                               |
| 提币账号       | get_account      | String     | true  | 13899996666                      | 发起提币的账户。                                             |
| 附加数据       | attach           | String     | false | 普通提币                         | 附加数据，在查询API和支付通知中原样返回，该字段主要用于商户携带订单的自定义数据。 |
| 随机字符串     | nonce_str        | String     | true  | FEC838C0BEA5468A82E2467DA4F70B8C | 随机字符串，不长于32位。                                     |
| 商户订单号     | out_trade_no     | String     | true  | 7faf7e60a92d4afa963b83933a949ecc | 商户系统内部的订单号,32个字符内、可包含字母。                |
| 签名类型       | sign_type        | String     | true  | MD5                              | 签名类型，默认为MD5                                          |
| 终端ip         | spbill_create_ip | String     | true  | 127.0.0.1                        | 必须传正确的用户端IP,支持ipv4、ipv6格式                      |
| 货币类型       | fee_type         | String     | true  | CNY                              | 符合ISO 4217标准的三位字母代码，[详见法币列表](#d6a9971a56)  |
| 交易类型       | trade_type       | String     | true  | WITHDRAW                         | 充币：DEPOSIT  提币：WITHDRAW                                |
| 充值金额       | total_amount     | BigDecimal | true  | 1000                             | 订单总金额                                                   |
| 结果通知地址   | notify_url       | String     | true  | https://www.baidu.com            | 接收BitFS支付异步通知回调地址，详情参考  ”回调通知“          |
| 时间戳         | timestamp        | String     | true  | 1585471277677                    | 发起订单时的时间毫秒数                                       |
| 商户appKey     | appKey           | String     | true  | 1e75e94982f80bd1f219ea807af96bd5 | BitFS分配的商户appKey                                        |
| 签名           | sign             | String     | true  | 13F9609AA53A8AEBED5516EE8696A995 | 签名，[详见签名生成算法](#7b81b8ce22)，默认MD5               |

### 返回结果

> response

~~~java
{
    "code": 0,
    "msg": "請求成功",
    "result": "{
        "mch_id":"441649692783284224",
    	"trade_type":"DEPOSIT",
    	"nonce_str":"FEC838C0BEA5468A82E2467DA4F70B8C",
    	"sign":"F752ABD95162A4A95E7C4A5E33DAEDD9"
	}"
}
~~~

| 字段       | 变量名 | 必填 | 类型        | 示例值  | 描述                                                         |
| ---------- | ------ | ---- | ----------- | ------- | ------------------------------------------------------------ |
| 返回状态码 | code   | true | Int         | 0       | 网关返回码，调用成功时返回0                                  |
| 返回信息   | msg    | true | String(255) | success | 当code不为0时返回信息为错误原因 ，例如 :签名失败  参数格式校验错误 |

<aside class="notice">以下字段在code为0时有返回</aside>

| 字段     | 变量       | 必填 | 类型   | 示例值                           | 描述                        |
| -------- | ---------- | ---- | ------ | -------------------------------- | --------------------------- |
| 商户ID   | mch_id     | true | String | 441649692783284224               | BitFS分配给商户的id         |
| 交易类型 | trade_type | true | String | WITHDRAW                         | 充币:DEPOSIT  提币:WITHDRAW |
| 随机字符 | nonce_str  | true | String | FEC838C0BEA5468A82E2467DA4F70B8C | BitFS返回的随机字符串       |
| 签名     | sign       | true | String | F752ABD95162A4A95E7C4A5E33DAEDD9 | BitFS返回的签名             |

### 错误码

| 名称                       | 描述                         | 原因                         | 解决方案                                   |
| -------------------------- | ---------------------------- | ---------------------------- | ------------------------------------------ |
| APPKEY_MCHID_NOT_MATCH     | 商户machId与商户appkey不匹配 | 商户machId与商户appkey不匹配 | 请确认appid和mch_id是否匹配                |
| SIGNERROR                  | 签名错误                     | 参数签名结果不正确           | 请检查签名参数和方法是否都符合签名算法要求 |
| OUT_TRADE_NO_USED          | 商户订单号重复               | 同一笔交易不能多次提交       | 请核实商户订单号是否重复提交               |
| LACK_PARAMS                | 缺少参数                     | 缺少必要的请求参数           | 请检查参数是否齐全                         |
| SYSTEMERROR                | 系统错误                     | 系统超时                     | 系统异常，请用相同参数重新调用             |
| COIN_NOT_EXIST             | 币种不支持                   | 请求的币种不支持             | 请参考币种列表上传正确的币种               |
| TRANSFER_ACCOUNT_NOT_EXIST | 转账账户不存在               | 商户账户不存在               | 请对商户账户信息是否正确                   |
| YOLLON_NOT_EXIST           | 收款账户不存在               | 提币用户Bitfs账户不存在      | 请确保提币账户为bitfs用户                  |

## 数字货币币种提币接口

### 应用场景

当BitFS用户在商户系统发起提现时，商户系统调用本接口可以方便地使用商户账户向用户转账，BitFS以实时行情汇率将数字货币金额兑换成USDT。

### 概括

* API名称：数字货币提币接口

* 请求方式：HTTP POST

* 请求URL：pay/v1/coinwithdraw

### 请求参数

> request:

~~~java
{
    "mch_id":"441649692783284224",
    "area_code":"0086",
    "get_account":"13899996666",
    "nonce_str":"FEC838C0BEA5468A82E2467DA4F70B8C",
    "out_trade_no":"7faf7e60a92d4afa963b83933a949ecc",
    "spbill_create_ip":127.0.0.1,
    "fee_type":"BTC",
    "trade_type":"WITHDRAW",
    "total_amount":"1000",
    "notify_url":"https://www.baidu.com",
    "timestamp":1585471277677,
    "appKey":"fc798420836184e33c042de1caa2814a",
    "sign":"F752ABD95162A4A95E7C4A5E33DAEDD9"
}
~~~

| 字段           | 变量名           | 类型       | 必填  | 示例值                           | 描述                                                         |
| -------------- | ---------------- | ---------- | ----- | -------------------------------- | ------------------------------------------------------------ |
| 商户ID         | mch_id           | String     | true  | 441649692783284224               | BitFS分配的商户ID                                            |
| 提币账户归属地 | area_code        | String     | true  | 0086                             |                                                              |
| 提币账号       | get_account      | String     | true  | 13899996666                      | 发起提币的账户。                                             |
| 附加数据       | attach           | String     | false | 普通提币                         | 附加数据，在查询API和支付通知中原样返回，该字段主要用于商户携带订单的自定义数据。 |
| 随机字符串     | nonce_str        | String     | true  | FEC838C0BEA5468A82E2467DA4F70B8C | 随机字符串，不长于32位。                                     |
| 商户订单号     | out_trade_no     | String     | true  | 7faf7e60a92d4afa963b83933a949ecc | 商户系统内部的订单号,32个字符内、可包含字母。                |
| 签名类型       | sign_type        | String     | true  | MD5                              | 签名类型，默认为MD5                                          |
| 终端ip         | spbill_create_ip | String     | true  | 127.0.0.1                        | 必须传正确的用户端IP,支持ipv4、ipv6格式                      |
| 货币类型       | fee_type         | String     | true  | BTC                              | 提币的币编码，[详见法币列表](#d6a9971a56)                    |
| 交易类型       | trade_type       | String     | true  | WITHDRAW                         | 充币DEPOSIT  提币WITHDRAW                                    |
| 充值金额       | total_amount     | BigDecimal | true  | 1000                             | 订单总金额                                                   |
| 结果通知地址   | notify_url       | String     | true  | https://www.baidu.com            | 接收BitFS支付异步通知回调地址，详情参考  ”回调通知“          |
| 时间戳         | timestamp        | String     | true  | 1585471277677                    | 发起订单时的时间毫秒数                                       |
| 商户appKey     | appKey           | String     | true  | 1e75e94982f80bd1f219ea807af96bd5 | BitFS分配的商户appKey                                        |
| 签名           | sign             | String     | true  | 13F9609AA53A8AEBED5516EE8696A995 | 签名，[详见签名生成算法](#7b81b8ce22)，默认MD5               |

### 返回结果

> response:

~~~java
{
    "code": 0,
    "msg": "請求成功",
    "result": "{
        "mch_id":"441649692783284224",
    	"trade_type":"DEPOSIT",
    	"nonce_str":"FEC838C0BEA5468A82E2467DA4F70B8C",
    	"sign":"F752ABD95162A4A95E7C4A5E33DAEDD9"
	}"
}
~~~

| 字段       | 变量名 | 必填 | 类型        | 示例值  | 描述                                                         |
| ---------- | ------ | ---- | ----------- | ------- | ------------------------------------------------------------ |
| 返回状态码 | code   | true | Int         | 0       | 网关返回码，调用成功时返回0                                  |
| 返回信息   | msg    | true | String(255) | success | 当code不为0时返回信息为错误原因 ，例如  签名失败  参数格式校验错误 |

<aside class="notice">以下字段在code为0时有返回</aside>

| 字段     | 变量       | 必填 | 类型   | 示例值                           | 描述                        |
| -------- | ---------- | ---- | ------ | -------------------------------- | --------------------------- |
| 商户ID   | mch_id     | true | String | 441649692783284224               | BitFS分配给商户的id         |
| 交易类型 | trade_type | true | String | WITHDRAW                         | 充币:DEPOSIT  提币:WITHDRAW |
| 随机字符 | nonce_str  | true | String | FEC838C0BEA5468A82E2467DA4F70B8C | BitFS返回的随机字符串       |
| 签名     | sign       | true | String | F752ABD95162A4A95E7C4A5E33DAEDD9 | BitFS返回的签名             |

### 错误码

| 名称                       | 描述                         | 原因                         | 解决方案                                   |
| -------------------------- | ---------------------------- | ---------------------------- | ------------------------------------------ |
| APPKEY_MCHID_NOT_MATCH     | 商户machId与商户appkey不匹配 | 商户machId与商户appkey不匹配 | 请确认appid和mch_id是否匹配                |
| SIGNERROR                  | 签名错误                     | 参数签名结果不正确           | 请检查签名参数和方法是否都符合签名算法要求 |
| OUT_TRADE_NO_USED          | 商户订单号重复               | 同一笔交易不能多次提交       | 请核实商户订单号是否重复提交               |
| LACK_PARAMS                | 缺少参数                     | 缺少必要的请求参数           | 请检查参数是否齐全                         |
| SYSTEMERROR                | 系统错误                     | 系统超时                     | 系统异常，请用相同参数重新调用             |
| COIN_NOT_EXIST             | 币种不支持                   | 请求的币种不支持             | 请参考币种列表上传正确的币种               |
| TRANSFER_ACCOUNT_NOT_EXIST | 转账账户不存在               | 商户账户不存在               | 请对商户账户信息是否正确                   |
| YOLLON_NOT_EXIST           | 收款账户不存在               | 提币用户Bitfs账户不存在      | 请确保提币账户为bitfs用户                  |

## 查询商户余额接口

### 应用场景

商户在BitFS注册成功后可以调用本接口方便的查询自身账户余额，灵活调整自身业务。

### 概括

* API名称：查询商户余额接口

* 请求方式：HTTP  POST

* 请求URL：pay/v1/checkacct

### 请求参数

> request:

~~~java
{
    "mch_id":"441649692783284224",
    "nonce_str":"FEC838C0BEA5468A82E2467DA4F70B8C",
    "fee_type":"usdt",
    "appKey":"f09b650179d5e01930d9c7b78c300147&3129384845945498",
    "sign":"F752ABD95162A4A95E7C4A5E33DAEDD9”
}
~~~

| 字段       | 变量名    | 必填  | 类型   | 示例值                           | 描述                |
| ---------- | --------- | ----- | ------ | -------------------------------- | ------------------- |
| 商户id     | mch_id    | true  | String | 441649692783284224               | BitFs分配给商户的id |
| 随机字符串 | nonce_str | true  | String | FEC838C0BEA5468A82E2467DA4F70B8C | 随机字符            |
| 币类型     | fee_type  | true  | String | BTC                              | 币编码              |
| appkey     | appkey    | true  | String | fc798420836184e33c042de1caa2814a | BitFs分配的appkey   |
| 签名       | sign      | true  | String | F752ABD95162A4A95E7C4A5E33DAEDD9 | 签名                |
| 签名类型   | sign_type | false | String | MD5                              | 签名类型，默认MD5   |

### 返回结果

> response:

~~~java
{
    "code": 0,
    "msg": "請求成功",
    "result": "{
        "mch_id":"441649692783284224",
    	"balance":"1000.56812",
    	"freeze":"1236.9872",
    	"nonce_str":"FEC838C0BEA5468A82E2467DA4F70B8C",
    	"sign":"F752ABD95162A4A95E7C4A5E33DAEDD9"

	}"
}
~~~

| 字段       | 变量名 | 必填 | 类型        | 示例值  | 描述                                                 |
| ---------- | ------ | ---- | ----------- | ------- | ---------------------------------------------------- |
| 返回状态码 | code   | true | Int         | 0       | 网关返回码，调用成功时返回0                          |
| 返回信息   | msg    | true | String(255) | success | 当code不为0时返回信息为错误原因 ，例如 :参数校验错误 |

<aside class="notice">以下字段在code为0时有返回</aside>

| 字段     | 变量      | 必填 | 类型   | 示例值                           | 描述                     |
| -------- | --------- | ---- | ------ | -------------------------------- | ------------------------ |
| 商户ID   | mch_id    | true | String | 441649692783284224               | BitFs分配给商户的id      |
| 可用余额 | balance   | true | String | 1000.56812                       | 商户当前币种的可用余额   |
| 冻结金额 | freeze    | true | String | 1236.9872                        | 商户当前币种的冻结的数量 |
| 随机字符 | nonce_str | true | String | FEC838C0BEA5468A82E2467DA4F70B8C | BitFs返回的随机字符串    |
| 签名     | sign      | true | String | F752ABD95162A4A95E7C4A5E33DAEDD9 | BitFs返回的签名          |

### 错误码

| 名称                   | 描述                         | 原因                         | 解决方案                                   |
| ---------------------- | ---------------------------- | ---------------------------- | ------------------------------------------ |
| APPKEY_MCHID_NOT_MATCH | 商户machId与商户appkey不匹配 | 商户machId与商户appkey不匹配 | 请确认appid和mch_id是否匹配                |
| SIGNERROR              | 签名错误                     | 参数签名结果不正确           | 请检查签名参数和方法是否都符合签名算法要求 |
| LACK_PARAMS            | 缺少参数                     | 缺少必要的请求参数           | 请检查参数是否齐全                         |
| SYSTEMERROR            | 系统错误                     | 系统超时                     | 系统异常，请用相同参数重新调用             |
| COIN_NOT_EXIST         | 币种不支持                   | 请求的币种不支持             | 请参考币种列表上传正确的币种               |

## 商户订单查询

### 应用场景

该接口提供所有BitFS支付订单的查询，商户可以通过查询订单接口主动查询订单状态，完成下一步的业务逻辑。

**需要调用查询接口的情况**

- 当商户后台、网络、服务器等出现异常，商户系统最终未接收到支付通知；
- 调用支付接口后，返回系统错误或未知交易状态情况；

### 概述

- API名称：代理商订单查询接口

- 请求方式：HTTP POST

- 请求URL：pay/v1/queryorder

### 请求参数

> request:

~~~java
{
    "mch_id":"441649692783284224",
    "out_trade_no":"7faf7e60a92d4afa963b83933a949ecc",
    "nonce_str":"FEC838C0BEA5468A82E2467DA4F70B8C",
    "appKey":"a58b139c85adbccf3a4b3a8e83a2bfba",
    "sign":"FB87C3106C43DF67513ABDFE8029A096"
}
~~~

| 字段       | 变量         | 必填  | 类型   | 示例值                           | 描述                                        |
| ---------- | ------------ | ----- | ------ | -------------------------------- | ------------------------------------------- |
| 商户id     | mch_id       | true  | String | 441649692783284224               | BitFs分配的商户                             |
| 商户订单号 | out_trade_no | true  | String | 7faf7e60a92d4afa963b83933a949ecc | 商户系统内部的订单号,32个字符内、可包含字母 |
| 随机字符串 | nonce_str    | true  | String | FEC838C0BEA5468A82E2467DA4F70B8C | 随机字符串                                  |
| 签名类型   | sign_type    | false | String | MD5                              | 签名类型，默认为MD5                         |
| Appkey     | appKey       | true  | String | a58b139c85adbccf3a4b3a8e83a2bfba | 商户的appkey                                |
| 签名       | sign         | true  | String | FB87C3106C43DF67513ABDFE8029A096 | 签名。                                      |

### 返回结果

> response:

~~~java
{
    "code": 0,
    "msg": "請求成功",
    "result": "{
        "mch_id":"441649692783284224",
    	"out_trade_no":"7faf7e60a92d4afa963b83933a949ecc",
    	"total_amount":"14.14",
    	"transaction_id":"44240523622d4b2ca836176cd88085d3",
    	"trade_type":"DEPOSIT",
    	"fee_type":"CNY",
    	"attach":"广州分店充值",
    	"trade_state":"100",
    	"tick_price":"7.00",
    	"order_fee":"2.02",
    	"trade_state_desc":"交易取消",
    	"nonce_str":"FEC838C0BEA5468A82E2467DA4F70B8C",
    	"sign":"F752ABD95162A4A95E7C4A5E33DAEDD9"
	}"
}
~~~

| 字段       | 变量名 | 必填 | 类型        | 示例值  | 描述                                               |
| ---------- | ------ | ---- | ----------- | ------- | -------------------------------------------------- |
| 返回状态码 | code   | true | Int         | 0       | 网关返回码，调用成功时返回0                        |
| 返回信息   | msg    | true | String(255) | success | 当code不为0时返回信息为错误原因 ，例如参数校验错误 |

<aside class="notice">以下字段在code为0时有返回</aside>

| 字段              | 变量             | 必填  | 类型   | 示例值                           | 描述                                                         |
| ----------------- | ---------------- | ----- | ------ | -------------------------------- | ------------------------------------------------------------ |
| 商户ID            | mch_id           | true  | String | 441649692783284224               | BitFS分配的商户                                              |
| BitFS交易用户标识 | customer_id      | false | String | 442314630598103040               | 扫码交易用户标识，当用户扫码获取订单时该字段有返回。         |
| 商户订单号        | out_trade_no     | true  | String | 7faf7e60a92d4afa963b83933a949ecc | 商户系统内部的订单号,32个字符内、可包含字母。                |
| 随机字符串        | nonce_str        | true  | String | FEC838C0BEA5468A82E2467DA4F70B8C | 随机字符串                                                   |
| 请求金额          | total_amount     | true  | String | 14.14                            | 商户请求交易的金额；当fee_type为法币时单位为元；当fee_type为数字货币时单位为 1个 |
| BitFS订单号       | transaction_id   | true  | String | 44240523622d4b2ca836176cd88085d3 | BitFS生成的订单号                                            |
| 交易类型          | trade_type       | true  | String | WITHDRAW                         | 充币DEPOSIT  提币WITHDRAW                                    |
| 交易币种          | fee_type         | true  | String | CNY                              | 发起请求的交易币种，分为法币和数字货币，[详见币种列表](#d6a9971a56)。 |
| 交易行情          | tick_price       | true  | String | 7.00                             | 发起请求时的BitFS行情价。                                    |
| 订单金额          | order_fee        | true  | String | 2.02                             | 实际交易的数字货币（USDT）数量。                             |
| 附加信息          | attach           | false | String | ”广州分店充值“                   | 商家的附加信息                                               |
| 交易状态          | trade_state      | true  | String | 100                              | 100 交易成功 ;200 交易失败;300 交易取消                      |
| 交易状态描述      | trade_state_desc | true  | String | 交易取消                         | 对交易状态的描述。                                           |
| 签名              | sign             | true  | String | F752ABD95162A4A95E7C4A5E33DAEDD9 | 签名。                                                       |

### 错误码

| 名称                   | 描述                         | 原因                         | 解决方案                                                     |
| ---------------------- | ---------------------------- | ---------------------------- | ------------------------------------------------------------ |
| APPKEY_MCHID_NOT_MATCH | 商户machId与商户appkey不匹配 | 商户machId与商户appkey不匹配 | 请确认appid和mch_id是否匹配                                  |
| SIGNERROR              | 签名错误                     | 参数签名结果不正确           | 请检查签名参数和方法是否都符合签名算法要求                   |
| LACK_PARAMS            | 缺少参数                     | 缺少必要的请求参数           | 请检查参数是否齐全                                           |
| SYSTEMERROR            | 系统错误                     | 系统超时                     | 系统异常，请用相同参数重新调用                               |
| ORDERNOTEXIST          | 订单号不存在                 | 查询系统中不存在此交易订单号 | 该API只能查提交交易返回成功的商户订单，请商户检查需要查询的商户订单号是否正确 |

## 订单信息回调通知接口

### 应用场景

支付完成后，BitFS会把相关支付结果发送给商户，商户需要接收处理，并按文档规范返回应答。

### 概括

- API名称:订单信息回调通知

- 请求方式：POST

- 请求连接：该链接是通过【充币/提币API】中提交的参数notify_url设置，如果链接无法访问，商户将无法接收到BitFS通知。

- 参数格式：application/json; charset=utf-8

### 回调参数

> request:

~~~java
{
    "mch_id":"441649692783284224",
    "out_trade_no":"7faf7e60a92d4afa963b83933a949ecc",
    "total_amount":"99.99",
    "transaction_id":"44240523622d4b2ca836176cd88085d3",
    "trade_type":"DEPOSIT",
    "fee_type":"CNY",
    "attach":"广州分店充值",
    "trade_state":"100",
    "tick_price":"7.00",
    "order_fee":"2.02",
    "trade_state_desc":"交易取消",
    "nonce_str":"FEC838C0BEA5468A82E2467DA4F70B8C",
    "sign":"F752ABD95162A4A95E7C4A5E33DAEDD9"
}
~~~

| 字段              | 变量             | 必填  | 类型   | 示例值                           | 描述                                                         |
| ----------------- | ---------------- | ----- | ------ | -------------------------------- | ------------------------------------------------------------ |
| 商户ID            | mch_id           | true  | String | 441649692783284224               | BitFS分配的商户                                              |
| BitFS交易用户标识 | customer_id      | false | String | 442314630598103040               | 扫码交易用户标识，当用户扫码获取订单时该字段有返回。         |
| 商户订单号        | out_trade_no     | true  | String | 7faf7e60a92d4afa963b83933a949ecc | 商户系统内部的订单号,32个字符内、可包含字母。                |
| 随机字符串        | nonce_str        | true  | String | FEC838C0BEA5468A82E2467DA4F70B8C | 随机字符串                                                   |
| 请求金额          | total_amount     | true  | String | 14.14                            | 当fee_type为法币时单位为元；当fee_type为数字货币时单位为 1个 |
| BitFS订单号       | transaction_id   | true  | String | 44240523622d4b2ca836176cd88085d3 | BitFS生成的订单号                                            |
| 交易类型          | trade_type       | true  | String | WITHDRAW                         | 充币DEPOSIT  提币WITHDRAW                                    |
| 交易行情          | tick_price       | true  | String | 7.00                             | 发起请求时的BitFS行情价。                                    |
| 订单金额          | order_fee        | true  | String | 2.02                             | 实际交易的数字货币（USDT）数量。                             |
| 交易币种          | fee_type         | true  | String | CNY                              | 发起请求的交易币种，分为法币和数字货币，[详见币种列表](#d6a9971a56)。 |
| 附加信息          | attach           | false | String | ”广州分店充值“                   | 商家的附加信息                                               |
| 交易状态          | trade_state      | true  | String | 100                              | 100 交易成功;200 交易失败;300 交易取消                       |
| 交易状态描述      | trade_state_desc | true  | String | 交易取消                         | 对交易状态的描述。                                           |
| 签名              | sign             | true  | String | F752ABD95162A4A95E7C4A5E33DAEDD9 | 签名。                                                       |

### 返回参数


| 字段       | 变量名      | 必填  | 类型   | 示例值  | 描述                                                       |
| ---------- | ----------- | ----- | ------ | ------- | ---------------------------------------------------------- |
| 返回状态码 | return_code | true  | String | SUCCESS | SUCCESS/FAIL  SUCCESS表示商户接收通知成功并校验成功        |
| 返回信息   | return_msg  | false | String | OK      | 返回信息，如非空，为错误原因：  签名失败  参数格式校验错误 |

## 签名算法

### 签名生成的通用步骤如下：



**第一步：**

设所有发送或者接收到的数据为集合M，将集合M内非空参数值的参数按照参数名ASCII码从小到大排序（字典序),

使用URL键值对的格式（即key1=value1&key2=value2…）拼接成字符串param_string。

以下为签名规则：

- 参数名ASCII码从小到大排序（字典序）；
- 如果参数的值为空不参与签名；
- 参数名区分大小写；
- 验证调用返回或BitFS 主动通知签名时，传送的sign参数不参与签名，将生成的签名与该sign值作校验。
- BitFS 接口可能增加字段，验证签名时必须支持增加的扩展字段



**第二步:**

在param_string最后拼接上key得到sign_string字符串，然后对sign_string进行MD5运算，再将得到的字符串所有字符转换为大写，得到sign值sign_value。

key设置路径：BitFS 商户平台-->设置-->商家私钥设置 



### 举例

传递如下参数：

`"mch_id":"441649692783284224",`

`"out_trade_no":"7faf7e60a92d4afa963b83933a949ecc",`

`"nonce_str":"FEC838C0BEA5468A82E2467DA4F70B8C",`

`"appKey":"a58b139c85adbccf3a4b3a8e83a2bfba",`



**第一步:**

将参数按字典序排序

`param_string=”appKey=a58b139c85adbccf3a4b3a8e83a2bfba&mch_id=441649692783284224&nonce_str=FEC838C0BEA5468A82E2467DA4F70B8C&out_trade_no=7faf7e60a92d4afa963b83933a949ecc“`



**第二步:**

拼接商户私钥然后进行MD5运算

`sign_string="param_string&key=3e678f6e4546f6968c99b52ae4b6659b2cc44d3543ae2fd7538ca48faabfc68e"`

`sign=MD5(sign_string).toUpperCase()="81A3948E5FFEF46F8A2FDE51D8EF3A6D"`



生成随机数算法

BitFS API接口协议中包含字段nonce_str，主要保证签名不可预测。推荐调用随机数函数生成，将得到的值转换为字符串。



## 交易货币类型

**1.法币类型**

| 币种名称 | 币种编码 |
| -------- | -------- |
| 人民币   | CNY      |
| 美元     | USD      |





**2.数字货币类型**

| 货币名称  | 货币编码 |
| --------- | -------- |
| 比特币    | BTC      |
| TetherUSD | USDT     |
| 以太坊    | ETH      |
